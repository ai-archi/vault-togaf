name: microservice-template
description: 单微服务标准知识库目录结构
type: dir-structure
structure:
  # 根 README
  - type: file
    name: README.md
    description: 微服务文档入口说明
    template: vault-assistant/archi-templates/content/microservice/service-overview.md

  # 1. 服务概览
  - type: directory
    name: 01-overview
    description: 微服务整体概览
    children:
      - type: file
        name: service-overview.md
        description: 服务简介、定位、上下文
        template: vault-assistant/archi-templates/content/microservice/service-overview.md
      - type: file
        name: context-diagram.md
        description: 系统上下文图（C4 Model L1）
        template: vault-assistant/archi-templates/content/microservice/context-diagram.md
      - type: file
        name: architecture.md
        description: 架构概览（C4 L2/L3、分层结构）
        template: vault-assistant/archi-templates/content/microservice/architecture.md

  # 2. DDD 领域文档
  - type: directory
    name: 02-domain
    description: 领域模型（DDD）
    children:
      # 顶层领域文档
      - type: file
        name: domain-overview.md
        description: 领域概览，包含总体领域划分和子领域说明
        template: vault-assistant/archi-templates/content/microservice/domain-overview.md
      - type: file
        name: subdomain-mapping.md
        description: 子领域映射（核心域/支撑域/通用域）和上下文映射（Context Mapping）
        template: vault-assistant/archi-templates/content/microservice/subdomain-mapping.md
      - type: file
        name: bounded-context.md
        description: 限界上下文定义和边界
        template: vault-assistant/archi-templates/content/microservice/bounded-context.md
      - type: file
        name: glossary.md
        description: 领域术语表（全局）
        template: vault-assistant/archi-templates/content/microservice/glossary.md
      # 子领域目录（示例：核心域）
      - type: directory
        name: core-domain
        description: 核心域目录（示例，请根据实际子领域名称重命名）
        children:
          - type: file
            name: README.md
            description: 子领域说明
            template: vault-assistant/archi-templates/content/microservice/subdomain-readme.md
          - type: file
            name: domain-model.md
            description: 聚合、实体、值对象、领域事件
            template: vault-assistant/archi-templates/content/microservice/domain-model.md
          - type: file
            name: use-cases.md
            description: 业务用例
            template: vault-assistant/archi-templates/content/microservice/use-cases.md
          - type: file
            name: aggregates.md
            description: 聚合根详细说明
            template: vault-assistant/archi-templates/content/microservice/aggregates.md
          - type: file
            name: domain-events.md
            description: 领域事件定义
            template: vault-assistant/archi-templates/content/microservice/domain-events.md
      # 子领域目录（示例：支撑域）
      - type: directory
        name: supporting-domain-xxx
        description: 支撑域目录（示例，请根据实际子领域名称重命名）
        children:
          - type: file
            name: README.md
            description: 子领域说明
            template: vault-assistant/archi-templates/content/microservice/subdomain-readme.md
          - type: file
            name: domain-model.md
            description: 领域模型
            template: vault-assistant/archi-templates/content/microservice/domain-model.md
          - type: file
            name: use-cases.md
            description: 业务用例
            template: vault-assistant/archi-templates/content/microservice/use-cases.md
      # 子领域目录（示例：通用域）
      - type: directory
        name: generic-domain-xxx
        description: 通用域目录（示例，请根据实际子领域名称重命名）
        children:
          - type: file
            name: README.md
            description: 子领域说明
            template: vault-assistant/archi-templates/content/microservice/subdomain-readme.md
          - type: file
            name: domain-model.md
            description: 领域模型
            template: vault-assistant/archi-templates/content/microservice/domain-model.md
          - type: file
            name: use-cases.md
            description: 业务用例
            template: vault-assistant/archi-templates/content/microservice/use-cases.md

  # 3. API 文档
  - type: directory
    name: 03-apis
    description: 服务接口文档（REST/GraphQL/Event）
    children:
      - type: file
        name: rest-api.md
        description: HTTP API 定义
        template: vault-assistant/archi-templates/content/microservice/rest-api.md
      - type: file
        name: event-api.md
        description: 事件接口（事件驱动架构）
        template: vault-assistant/archi-templates/content/microservice/event-api.md
      - type: file
        name: api-contract.md
        description: API契约定义
        template: vault-assistant/archi-templates/content/microservice/api-contract.md

  # 4. 数据存储
  - type: directory
    name: 04-storage
    description: 数据库与数据流
    children:
      - type: file
        name: schema.md
        description: 数据库结构文档
        template: vault-assistant/archi-templates/content/microservice/schema.md
      - type: file
        name: ddl
        description: 数据库 DDL 版本文件
      - type: file
        name: migration-history.md
        description: 迁移历史（适配 Anchor Model）
        template: vault-assistant/archi-templates/content/microservice/migration-history.md
      - type: file
        name: dataflow.md
        description: 数据流、事件流说明
        template: vault-assistant/archi-templates/content/microservice/dataflow.md

  # 5. 运维 & SRE
  - type: directory
    name: 05-operations
    description: 运维、部署、可观测性
    children:
      - type: file
        name: deployment.md
        description: 部署架构（K8s/Mesh）
        template: vault-assistant/archi-templates/content/microservice/deployment.md
      - type: file
        name: runbook.md
        description: 故障处理手册
        template: vault-assistant/archi-templates/content/microservice/runbook.md
      - type: file
        name: sre.md
        description: SLA/SLO/SLI 设计
        template: vault-assistant/archi-templates/content/microservice/sre.md
      - type: file
        name: observability.md
        description: Metrics/Logs/Tracing
        template: vault-assistant/archi-templates/content/microservice/observability.md
      - type: file
        name: dependencies.md
        description: 外部依赖清单
        template: vault-assistant/archi-templates/content/microservice/dependencies.md

  # 6. 测试
  - type: directory
    name: 06-testing
    description: 测试策略与记录
    children:
      - type: file
        name: test-strategy.md
        description: 单测、集测、契约测试策略
        template: vault-assistant/archi-templates/content/microservice/test-strategy.md
      - type: file
        name: performance-test.md
        description: 性能/压力测试
        template: vault-assistant/archi-templates/content/microservice/performance-test.md
      - type: file
        name: test-cases
        description: 测试用例集

  # 7. 安全
  - type: directory
    name: 07-security
    description: 安全策略
    children:
      - type: file
        name: threat-model.md
        description: 威胁建模（STRIDE）
        template: vault-assistant/archi-templates/content/microservice/threat-model.md
      - type: file
        name: authz-authn.md
        description: 鉴权认证策略
        template: vault-assistant/archi-templates/content/microservice/authz-authn.md
      - type: file
        name: data-protection.md
        description: 数据保护、加密、脱敏
        template: vault-assistant/archi-templates/content/microservice/data-protection.md
      - type: file
        name: audit.md
        description: 审计日志规范
        template: vault-assistant/archi-templates/content/microservice/audit.md

  # 8. 交付 & CI/CD
  - type: directory
    name: 08-delivery
    description: 交付、版本管理、CI-CD
    children:
      - type: file
        name: ci.md
        description: CI 流水线配置
        template: vault-assistant/archi-templates/content/microservice/ci.md
      - type: file
        name: cd.md
        description: CD / 灰度 / 蓝绿发布
        template: vault-assistant/archi-templates/content/microservice/cd.md
      - type: file
        name: environments.md
        description: 环境说明（dev/stage/prod）
        template: vault-assistant/archi-templates/content/microservice/environments.md
      - type: file
        name: release-notes
        description: 发布说明记录

  # 9. 架构决策 ADR
  - type: directory
    name: 09-decisions
    description: 架构决策记录（ADR）
    children:
      - type: file
        name: ADR-0001-template.md
        description: ADR 模板文件/示例
        template: vault-assistant/archi-templates/content/markdown/adr-template.md
